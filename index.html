<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë§ˆìŠ¤í„° íŠ¸ë ˆì´ë”© ëŒ€ì‹œë³´ë“œ (Lite)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        body {
            font-family: "Pretendard", -apple-system, sans-serif;
            background-color: #f8fafc;
            -webkit-tap-highlight-color: transparent;
        }
        .tabular-nums {
            font-variant-numeric: tabular-nums;
            font-feature-settings: "tnum";
            font-family: "Pretendard", sans-serif; 
        }
        .btn-select { transition: all 0.2s; }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="pb-20 text-slate-800">

    <div class="max-w-5xl mx-auto p-4 md:p-6 space-y-6">
        
        <!-- Header -->
        <header class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div>
                    <h1 class="text-2xl font-bold text-slate-900 flex items-center gap-2">
                        <span id="app-icon" class="text-2xl">ğŸ’</span>
                        <span id="header-title">ì„ ë¬¼ ë§ˆìŠ¤í„° ëŒ€ì‹œë³´ë“œ</span>
                    </h1>
                    <p class="text-slate-500 text-sm mt-1">5ëŒ€ ì„ ë¬¼ ì¢…ëª© ì™„ì „ ì •ë³µ</p>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto">
                    <!-- Position Toggle -->
                    <div class="bg-slate-100 p-1 rounded-xl flex font-bold text-sm w-full sm:w-auto">
                        <button id="mode-long" onclick="setMode('LONG')" class="flex-1 px-4 py-2.5 rounded-lg shadow-sm bg-white text-red-600 transition-all">
                            ğŸ“ˆ ë¡± (ë§¤ìˆ˜)
                        </button>
                        <button id="mode-short" onclick="setMode('SHORT')" class="flex-1 px-4 py-2.5 rounded-lg text-slate-400 hover:text-slate-600 transition-all">
                            ğŸ“‰ ìˆ (ë§¤ë„)
                        </button>
                    </div>

                    <!-- Ticker Select -->
                    <div class="relative w-full sm:w-auto">
                        <select id="ticker-select" class="w-full appearance-none bg-slate-50 border border-slate-200 text-slate-800 py-3 pl-4 pr-10 rounded-xl font-bold text-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="ES">ES - S&P 500</option>
                            <option value="NQ">NQ - ë‚˜ìŠ¤ë‹¥ 100</option>
                            <option value="GC">GC - ê³¨ë“œ ì„ ë¬¼</option>
                            <option value="6E">6E - ìœ ë¡œ FX</option>
                            <option value="6J">6J - ì—”í™” ì„ ë¬¼</option>
                        </select>
                        <svg class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 w-5 h-5 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </div>
                </div>
            </div>

            <!-- Info Box -->
            <div id="strategy-info-box" class="mt-6 p-4 rounded-2xl bg-slate-50 border border-slate-200 flex items-start gap-3 transition-colors duration-300">
                <div id="info-icon" class="mt-0.5">â„¹ï¸</div>
                <div>
                    <h3 id="strategy-title" class="font-bold text-slate-800 text-sm mb-1">ì „ëµ ë¡œë”©ì¤‘...</h3>
                    <p id="strategy-desc" class="text-slate-700 text-sm">...</p>
                    <p id="strategy-tip" class="text-slate-600 text-xs mt-2 font-medium bg-white/50 inline-block px-2 py-1 rounded">...</p>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            
            <!-- Left Column: Analysis -->
            <div class="lg:col-span-2 space-y-6">
                
                <!-- Checklist -->
                <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200 transition-colors duration-500 h-full" id="checklist-card">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="font-bold text-lg flex items-center gap-2 text-slate-800">
                            âœ… ì§„ì… ì²´í¬ë¦¬ìŠ¤íŠ¸
                        </h2>
                        <button onclick="resetAnalysis()" class="text-slate-400 p-2 hover:bg-slate-50 rounded-full transition-colors" title="ì´ˆê¸°í™”">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                        </button>
                    </div>

                    <div class="space-y-6">
                        <!-- 1. Trend Check -->
                        <div>
                            <label id="label-trend" class="text-sm font-semibold text-slate-600 block mb-2">1. 1ì‹œê°„ë´‰ ì¶”ì„¸ (EMA 200)</label>
                            <div class="grid grid-cols-2 gap-3">
                                <button id="btn-trend-ok" onclick="setTrend(true)" class="btn-select py-5 px-2 rounded-xl text-sm font-bold border bg-white border-slate-200 text-slate-400 flex flex-col items-center gap-1">
                                    <span id="text-trend-ok">ğŸ‘ ì§„ì… ë°©í–¥ ì¼ì¹˜</span>
                                </button>
                                <button id="btn-trend-no" onclick="setTrend(false)" class="btn-select py-5 px-2 rounded-xl text-sm font-bold border bg-white border-slate-200 text-slate-400 flex flex-col items-center gap-1">
                                    <span id="text-trend-no">ğŸ‘ ì—­ì¶”ì„¸ (ìœ„í—˜)</span>
                                </button>
                            </div>
                        </div>

                        <!-- 2. RSI Check -->
                        <div>
                            <label class="text-sm font-semibold text-slate-600 flex justify-between mb-2">
                                <span>2. 15ë¶„ë´‰ RSI (14)</span>
                                <span id="rsi-badge" class="text-xs px-2 py-1 rounded font-bold bg-slate-100 text-slate-500">-</span>
                            </label>
                            <div class="relative">
                                <input type="number" id="rsi-input" placeholder="RSI ê°’ ì…ë ¥" class="w-full p-4 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-300 font-medium bg-slate-50 focus:bg-white transition-all tabular-nums text-lg">
                                <div id="rsi-indicator" class="absolute right-4 top-1/2 -translate-y-1/2 text-xs font-bold"></div>
                            </div>
                        </div>

                        <!-- 3. Band Check -->
                        <div>
                            <label class="text-sm font-semibold text-slate-600 block mb-2">3. 15ë¶„ë´‰ ë³¼ë¦°ì € ë°´ë“œ</label>
                            <div class="relative">
                                <select id="band-select" class="w-full p-4 appearance-none border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-300 bg-white font-medium text-lg">
                                    <option value="middle">ë°´ë“œ ì•ˆìª½ (ê´€ë§)</option>
                                    <option value="good" id="opt-band-good">--</option>
                                    <option value="bad" id="opt-band-bad">--</option>
                                </select>
                                <svg class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 w-5 h-5 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                    </div>

                    <button id="btn-analyze" onclick="analyze()" disabled class="w-full mt-8 py-5 bg-slate-300 text-white font-bold rounded-2xl transition-all shadow-none flex justify-center items-center gap-2 cursor-not-allowed text-lg">
                        ë¶„ì„ ì‹œì‘
                    </button>

                    <!-- Result Box -->
                    <div id="result-box" class="hidden mt-6 p-6 bg-slate-50 rounded-2xl border border-slate-200 fade-in">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-bold text-slate-800">ğŸ¯ ë¶„ì„ ê²°ê³¼</h3>
                            <span id="result-badge" class="px-4 py-2 rounded-xl text-sm font-bold bg-slate-600 text-white">ëŒ€ê¸°</span>
                        </div>
                        <div id="result-reasons" class="space-y-3 bg-white p-4 rounded-xl border border-slate-100 text-sm text-slate-600 font-medium"></div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Calculator -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Calculator -->
                <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200 sticky top-6 z-10 transition-colors duration-500" id="calc-card">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="p-2.5 rounded-xl bg-slate-100 text-slate-600" id="calc-icon-bg">
                            <span id="calc-icon">ğŸ§®</span>
                        </div>
                        <div>
                            <h2 class="font-bold text-lg text-slate-800" id="calc-title">ëª©í‘œê°€ ê³„ì‚°ê¸°</h2>
                            <p id="calc-subtitle" class="text-xs text-slate-400">í‹± ë‹¨ìœ„ ì •ë°€ ë³´ì •</p>
                        </div>
                    </div>
                    
                    <div class="mb-6 relative">
                        <span class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-bold">$</span>
                        <input type="number" id="price-input" placeholder="í˜„ì¬ê°€ ì…ë ¥" class="w-full pl-8 p-4 border border-slate-200 rounded-xl tabular-nums text-xl font-bold text-slate-800 focus:outline-none focus:ring-2 bg-slate-50 transition-all">
                    </div>

                    <div id="calc-result" class="hidden space-y-4 fade-in">
                        <!-- TP -->
                        <div class="p-5 bg-emerald-50 rounded-2xl border border-emerald-100">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-xs font-bold text-emerald-600 uppercase">ìµì ˆ (TP)</span>
                                <span id="tp-percent" class="bg-white/80 px-2 py-0.5 rounded text-[10px] font-bold text-emerald-600"></span>
                            </div>
                            <div id="tp-price" class="text-3xl font-bold text-emerald-700 tabular-nums tracking-tight"></div>
                            <div class="text-xs text-emerald-600 mt-2 font-medium">ì˜ˆìƒ ìˆ˜ìµ: <span id="roe-text" class="bg-emerald-200/50 px-1 rounded font-bold"></span> (7.5ë°°)</div>
                        </div>
                        <!-- SL -->
                        <div class="p-5 bg-rose-50 rounded-2xl border border-rose-100">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-xs font-bold text-rose-600 uppercase">ì†ì ˆ (SL)</span>
                                <span id="sl-percent" class="bg-white/80 px-2 py-0.5 rounded text-[10px] font-bold text-rose-600"></span>
                            </div>
                            <div id="sl-price" class="text-3xl font-bold text-rose-700 tabular-nums tracking-tight"></div>
                        </div>
                    </div>
                </div>

                <!-- Guide -->
                <div class="bg-slate-800 text-slate-300 p-6 rounded-3xl shadow-lg relative overflow-hidden">
                    <h3 class="font-bold text-white mb-4 text-lg z-10 relative">ğŸ’¡ ë§¤ë§¤ ì›ì¹™</h3>
                    <ul id="guide-list" class="space-y-3 text-sm relative z-10"></ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Script -->
    <script>
        // --- DATA (ì—”í™” í¬í•¨, ì •ë°€ ê³„ì‚° ì ìš©) ---
        const STRATEGIES = {
            ES: { name: 'S&P 500', rsiLong: 35, rsiShort: 65, tp: 0.002, sl: 0.0015, color: 'red', tick: 0.25, prec: 2 },
            NQ: { name: 'ë‚˜ìŠ¤ë‹¥ 100', rsiLong: 25, rsiShort: 75, tp: 0.003, sl: 0.0025, color: 'violet', tick: 0.25, prec: 2 },
            GC: { name: 'ê³¨ë“œ ì„ ë¬¼', rsiLong: 25, rsiShort: 75, tp: 0.0025, sl: 0.002, color: 'amber', tick: 0.1, prec: 1 },
            '6E': { name: 'ìœ ë¡œ FX', rsiLong: 30, rsiShort: 70, tp: 0.002, sl: 0.0015, color: 'indigo', tick: 0.00005, prec: 5 },
            '6J': { name: 'ì—”í™” ì„ ë¬¼', rsiLong: 30, rsiShort: 70, tp: 0.002, sl: 0.0015, color: 'pink', tick: 0.0000005, prec: 7 }
        };

        // --- STATE ---
        let mode = 'LONG'; 
        let ticker = 'ES';
        let trendOk = null;
        let rsiVal = '';
        let bandStatus = 'middle'; 

        const el = (id) => document.getElementById(id);
        
        function init() {
            renderUI();
            el('ticker-select').addEventListener('change', (e) => {
                ticker = e.target.value;
                resetAnalysis();
                renderUI();
                calc();
            });
            el('rsi-input').addEventListener('input', (e) => {
                rsiVal = e.target.value;
                checkRSI();
                checkBtn();
            });
            el('band-select').addEventListener('change', (e) => {
                bandStatus = e.target.value;
            });
            el('price-input').addEventListener('input', calc);
        }

        function setMode(newMode) {
            mode = newMode;
            if (mode === 'LONG') {
                el('mode-long').className = 'flex-1 px-4 py-2.5 rounded-lg shadow-sm bg-white text-red-600 transition-all';
                el('mode-short').className = 'flex-1 px-4 py-2.5 rounded-lg text-slate-400 hover:text-slate-600 transition-all';
            } else {
                el('mode-short').className = 'flex-1 px-4 py-2.5 rounded-lg shadow-sm bg-white text-blue-600 transition-all';
                el('mode-long').className = 'flex-1 px-4 py-2.5 rounded-lg text-slate-400 hover:text-slate-600 transition-all';
            }
            resetAnalysis();
            renderUI();
            calc();
        }

        function renderUI() {
            const cfg = STRATEGIES[ticker];
            const isLong = mode === 'LONG';
            const themeColor = isLong ? 'red' : 'blue';
            
            const infoBoxClass = isLong 
                ? 'mt-6 p-4 rounded-2xl flex items-start gap-3 transition-colors duration-300 bg-red-50 border border-red-100'
                : 'mt-6 p-4 rounded-2xl flex items-start gap-3 transition-colors duration-300 bg-blue-50 border border-blue-100';
            
            el('strategy-info-box').className = infoBoxClass;
            el('strategy-title').innerText = `${cfg.name} - ${isLong ? 'ë§¤ìˆ˜(Long)' : 'ë§¤ë„(Short)'} ì „ëµ`;
            el('strategy-title').className = `font-bold text-sm mb-1 text-${themeColor}-700`;
            
            if (isLong) {
                el('info-icon').innerText = 'ğŸ“ˆ';
                el('strategy-desc').innerText = 'ìƒìŠ¹ ì¶”ì„¸ì—ì„œ ëˆŒë¦¼ëª©ì„ ì¡ìœ¼ì„¸ìš”.';
                el('strategy-tip').innerText = `Tip: í‹± ë‹¨ìœ„(${cfg.tick})ë¡œ ì •ë°€ ë³´ì •ë©ë‹ˆë‹¤.`;
                
                el('text-trend-ok').innerText = 'ğŸ“ˆ ìƒìŠ¹ ì¶”ì„¸ (EMA 200 ìœ„)';
                el('text-trend-no').innerText = 'ğŸ“‰ í•˜ë½ ì¶”ì„¸ (ì§„ì… ê¸ˆì§€)';
                
                el('opt-band-good').innerText = 'ë°´ë“œ í•˜ë‹¨ í„°ì¹˜ (ë§¤ìˆ˜ ê¸°íšŒ)';
                el('opt-band-bad').innerText = 'ë°´ë“œ ìƒë‹¨ í„°ì¹˜ (ë§¤ë„ êµ¬ê°„)';
                
                el('rsi-badge').innerText = `ë§¤ìˆ˜ ê¸°ì¤€: ${cfg.rsiLong} ì´í•˜`;
                el('rsi-badge').className = `text-xs px-2 py-1 rounded font-bold bg-red-100 text-red-600`;
                el('rsi-input').placeholder = `${cfg.rsiLong} ì´í•˜ ì¶”ì²œ`;
            } else {
                el('info-icon').innerText = 'ğŸ“‰';
                el('strategy-desc').innerText = 'í•˜ë½ ì¶”ì„¸ì—ì„œ ë°˜ë“± ì‹œ ë§¤ë„í•˜ì„¸ìš”.';
                el('strategy-tip').innerText = `Tip: í‹± ë‹¨ìœ„(${cfg.tick})ë¡œ ì •ë°€ ë³´ì •ë©ë‹ˆë‹¤.`;
                
                el('text-trend-ok').innerText = 'ğŸ“‰ í•˜ë½ ì¶”ì„¸ (EMA 200 ì•„ë˜)';
                el('text-trend-no').innerText = 'ğŸ“ˆ ìƒìŠ¹ ì¶”ì„¸ (ì§„ì… ê¸ˆì§€)';
                
                el('opt-band-good').innerText = 'ë°´ë“œ ìƒë‹¨ í„°ì¹˜ (ë§¤ë„ ê¸°íšŒ)';
                el('opt-band-bad').innerText = 'ë°´ë“œ í•˜ë‹¨ í„°ì¹˜ (ì²­ì‚° êµ¬ê°„)';
                
                el('rsi-badge').innerText = `ë§¤ë„ ê¸°ì¤€: ${cfg.rsiShort} ì´ìƒ`;
                el('rsi-badge').className = `text-xs px-2 py-1 rounded font-bold bg-blue-100 text-blue-600`;
                el('rsi-input').placeholder = `${cfg.rsiShort} ì´ìƒ ì¶”ì²œ`;
            }

            el('calc-title').innerText = isLong ? 'ë§¤ìˆ˜ ëª©í‘œê°€' : 'ë§¤ë„ ëª©í‘œê°€';
            el('calc-subtitle').innerText = `ë‹¨ìœ„: ${cfg.tick} (${isLong ? 'ì˜¬ë¦¼' : 'ë‚´ë¦¼'})`;
            el('calc-icon').innerText = isLong ? 'ğŸ‚' : 'ğŸ»';
            el('calc-icon-bg').className = isLong ? 'p-2.5 rounded-xl bg-red-50' : 'p-2.5 rounded-xl bg-blue-50';

            const trendText = isLong ? "EMA 200 ìœ„" : "EMA 200 ì•„ë˜";
            const rsiText = isLong ? `RSI ${cfg.rsiLong} ì´í•˜` : `RSI ${cfg.rsiShort} ì´ìƒ`;
            const bandText = isLong ? "ë³¼ë¦°ì € í•˜ë‹¨" : "ë³¼ë¦°ì € ìƒë‹¨";
            
            el('guide-list').innerHTML = `
                <li class="flex gap-3 items-center"><span class="bg-slate-700 text-white w-5 h-5 flex items-center justify-center rounded-full text-xs font-bold">1</span><span>${trendText} í™•ì¸</span></li>
                <li class="flex gap-3 items-center"><span class="bg-slate-700 text-white w-5 h-5 flex items-center justify-center rounded-full text-xs font-bold">2</span><span>${rsiText} + ${bandText}</span></li>
                <li class="flex gap-3 items-center"><span class="bg-slate-700 text-white w-5 h-5 flex items-center justify-center rounded-full text-xs font-bold">3</span><span>${(cfg.tp * 100).toFixed(2)}% ìˆ˜ìµ ì‹œ ì¹¼ìµì ˆ</span></li>
            `;
        }

        function setTrend(isOk) {
            trendOk = isOk;
            const activeClass = 'btn-select py-5 px-2 rounded-xl text-sm font-bold border ring-2 shadow-md transform scale-[1.02]';
            const inactiveClass = 'btn-select py-5 px-2 rounded-xl text-sm font-bold border bg-white border-slate-200 text-slate-400 opacity-60';
            
            if (isOk) {
                const color = mode === 'LONG' ? 'red' : 'blue';
                el('btn-trend-ok').className = `${activeClass} bg-${color}-50 border-${color}-200 text-${color}-600 ring-${color}-100`;
                el('btn-trend-no').className = inactiveClass;
            } else {
                el('btn-trend-no').className = `${activeClass} bg-slate-100 border-slate-300 text-slate-600 ring-slate-200`;
                el('btn-trend-ok').className = inactiveClass;
            }
            checkBtn();
        }

        function checkRSI() {
            const val = parseFloat(rsiVal);
            const cfg = STRATEGIES[ticker];
            if (isNaN(val)) { el('rsi-indicator').innerText = ''; return; }
            
            const isGood = mode === 'LONG' ? val <= cfg.rsiLong : val >= cfg.rsiShort;
            const isBad = mode === 'LONG' ? val >= 70 : val <= 30; 

            if (isGood) el('rsi-indicator').innerHTML = '<span class="text-emerald-500 bg-emerald-50 px-2 py-1 rounded">ğŸŸ¢ ì§„ì… êµ¿</span>';
            else if (isBad) el('rsi-indicator').innerHTML = '<span class="text-rose-500 bg-rose-50 px-2 py-1 rounded">ğŸ”´ ìœ„í—˜</span>';
            else el('rsi-indicator').innerText = '';
        }

        function checkBtn() {
            const theme = mode === 'LONG' ? 'red' : 'blue';
            if (trendOk !== null && rsiVal) {
                el('btn-analyze').disabled = false;
                el('btn-analyze').className = `w-full mt-8 py-5 text-white font-bold rounded-2xl transition-all shadow-md flex justify-center items-center gap-2 hover:opacity-90 bg-${theme}-500 text-lg`;
            } else {
                el('btn-analyze').disabled = true;
                el('btn-analyze').className = `w-full mt-8 py-5 bg-slate-300 text-white font-bold rounded-2xl transition-all shadow-none flex justify-center items-center gap-2 cursor-not-allowed text-lg`;
            }
        }

        function analyze() {
            const cfg = STRATEGIES[ticker];
            const rsi = parseFloat(rsiVal);
            let score = 0;
            let reasons = [];
            
            if (trendOk) {
                score += 30;
                reasons.push(mode === 'LONG' ? 'âœ… ìƒìŠ¹ ì¶”ì„¸ í™•ì¸ (Good)' : 'âœ… í•˜ë½ ì¶”ì„¸ í™•ì¸ (Good)');
            } else {
                score -= 100;
                reasons.push('â›”ï¸ ì¶”ì„¸ ì—­í–‰ì…ë‹ˆë‹¤. ì§„ì… ê¸ˆì§€.');
            }

            const isRsiGood = mode === 'LONG' ? rsi <= cfg.rsiLong : rsi >= cfg.rsiShort;
            if (isRsiGood) {
                score += 40;
                reasons.push(`âœ… RSI ${rsi} (ê¸°ì¤€ ë§Œì¡±)`);
            } else {
                reasons.push(`â„¹ï¸ RSI ì¤‘ë¦½/ë¶ˆë§Œì¡±`);
            }

            if (bandStatus === 'good') {
                score += 30;
                reasons.push('âœ… ë³¼ë¦°ì € ë°´ë“œ í„°ì¹˜ (Good)');
            } else if (bandStatus === 'bad') {
                score -= 30;
                reasons.push('âš ï¸ ë°´ë“œ ë°˜ëŒ€í¸ í„°ì¹˜ (ìœ„í—˜)');
            }

            el('result-box').classList.remove('hidden');
            let status = '';
            let bg = '';
            
            if (score >= 80) { status = 'ğŸ”¥ ê°•ë ¥ ì¶”ì²œ'; bg = 'bg-red-500'; }
            else if (score >= 50) { status = 'âœ¨ ì§„ì… ì í•©'; bg = 'bg-orange-500'; }
            else if (score < 0) { status = 'âœ‹ ì§„ì… ê¸ˆì§€'; bg = 'bg-slate-600'; }
            else { status = 'â³ ê´€ë§ í•„ìš”'; bg = 'bg-yellow-400'; }
            
            el('result-badge').innerText = status;
            el('result-badge').className = `px-4 py-2 rounded-xl text-sm font-bold text-white shadow-sm ${bg}`;
            el('result-reasons').innerHTML = reasons.map(r => `<div>${r}</div>`).join('');
        }

        function calc() {
            const price = parseFloat(el('price-input').value);
            if (isNaN(price)) { el('calc-result').classList.add('hidden'); return; }
            el('calc-result').classList.remove('hidden');
            
            const cfg = STRATEGIES[ticker];
            const roe = (cfg.tp * 100 * 7.5).toFixed(2);
            
            let tpRaw, slRaw;
            let tpPrice, slPrice;

            if (mode === 'LONG') {
                tpRaw = price * (1 + cfg.tp);
                slRaw = price * (1 - cfg.sl);
                
                // Long: Round Up (Ceil)
                const mult = Math.round(1 / cfg.tick); 
                if (mult > 1) {
                    tpPrice = Math.ceil(tpRaw / cfg.tick) * cfg.tick;
                    slPrice = Math.ceil(slRaw / cfg.tick) * cfg.tick;
                } else {
                    tpPrice = Math.ceil(tpRaw / cfg.tick) * cfg.tick;
                    slPrice = Math.ceil(slRaw / cfg.tick) * cfg.tick;
                }

                el('tp-percent').innerText = `+${(cfg.tp*100).toFixed(2)}%`;
                el('sl-percent').innerText = `-${(cfg.sl*100).toFixed(2)}%`;
            } else {
                tpRaw = price * (1 - cfg.tp);
                slRaw = price * (1 + cfg.sl);

                // Short: Round Down (Floor)
                tpPrice = Math.floor(tpRaw / cfg.tick) * cfg.tick;
                slPrice = Math.floor(slRaw / cfg.tick) * cfg.tick;

                el('tp-percent').innerText = `-${(cfg.tp*100).toFixed(2)}%`;
                el('sl-percent').innerText = `+${(cfg.sl*100).toFixed(2)}%`;
            }

            el('tp-price').innerText = `$${tpPrice.toFixed(cfg.prec)}`;
            el('sl-price').innerText = `$${slPrice.toFixed(cfg.prec)}`;
            el('roe-text').innerText = `+${roe}%`;
        }

        function resetAnalysis() {
            trendOk = null;
            rsiVal = '';
            bandStatus = 'middle';
            el('rsi-input').value = '';
            el('band-select').value = 'middle';
            el('result-box').classList.add('hidden');
            el('rsi-indicator').innerText = '';
            
            const inactive = 'btn-select py-5 px-2 rounded-xl text-sm font-bold border bg-white border-slate-200 text-slate-400 flex flex-col items-center gap-1';
            el('btn-trend-ok').className = inactive;
            el('btn-trend-no').className = inactive;
            checkBtn();
        }

        init();
    </script>
</body>
</html>


